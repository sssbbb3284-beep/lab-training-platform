<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Prototype</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
/* Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„ØµÙØ­Ø© */
body {
  margin:0;
  padding:0;
  height:100dvh;
  width:100vw;
  background-color:#001f3f;
  font-family:Arial, sans-serif;
  overflow:hidden;
  position:relative;
}

/* Ø´Ø¹Ø§Ø± Ø§Ù„Ø®Ù„ÙÙŠÙ‡ */
body::before {
  content:"";
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
  width:300px;
  height:300px;
  background-image:url('logo.png');
  background-size:contain;
  background-repeat:no-repeat;
  opacity:0.1;
  z-index:1;
}

/* Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
.welcome {
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%, -50%);
  text-align:center;
  color:white;
  z-index:2;
  width:90%;
}
.welcome h1 { font-size:50px; margin-bottom:20px; }
.welcome p { font-size:20px; margin-bottom:40px; }

/* Ø²Ø± Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
#startBtn {
  padding:15px 50px;
  font-size:22px;
  background-color:#ffffff;
  color:#001f3f;
  border:none;
  border-radius:10px;
  cursor:pointer;
}
#startBtn:hover {
  background-color:#ddd;
}

/* Ø²Ø± NEXT (Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„ØµØ­ÙŠØ­ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ) */
#nextBtn {
  display:none;
  position:absolute;
  border-radius:12px;
  font-size:16px;
  cursor:pointer;
  z-index:5;
  transition:0.2s;

  /* âœ¨ Ø®Ù„ÙÙŠØ© Ø´ÙØ§ÙØ© Ø¬Ù…ÙŠÙ„Ø© */
  background-color: rgba(255,255,255,0.28);

  /* âœ¨ ØªØ¨Ù‚ÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ© ÙˆØ§Ø¶Ø­Ø© */
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);

  /* âœ¨ Ø¥Ø·Ø§Ø± Ø®ÙÙŠÙ */
  border: 1px solid rgba(255,255,255,0.25);

  /* âœ¨ Ø¸Ù„ Ù†Ø§Ø¹Ù… */
  box-shadow: 0 0 6px rgba(0,0,0,0.25);

  color: black;
}

/* Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª */
video {
  width:100%;
  height:100%;
  object-fit:contain;
  display:none;
  position:absolute;
  top:0;
  left:0;
  z-index:2;

  outline:none;
  border:none;
  background:transparent;
}
/* Ø¥Ø®ÙØ§Ø¡ Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙÙŠØ¯ÙŠÙˆ */
video::-webkit-media-controls { display:none !important; }

/* Ø§Ù„Ø³Ø¤Ø§Ù„ */
.questionBar {
  position:absolute;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  width:90%;
  background-color:rgba(0,0,0,0.85);
  color:white;
  padding:15px;
  border-radius:10px;
  display:none;
  justify-content:center;
  align-items:center;
  z-index:5;
}
.questionBar span { margin-right:15px; }
.questionBar button {
  margin:0 15px;
  padding:10px 25px;
  font-size:16px;
  border:none;
  border-radius:8px;
  cursor:pointer;
}

/* Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© */
.statusBar {
  position:absolute;
  top:10px;
  left:10px;
  right:10px;
  display:flex;
  justify-content:space-between;
  padding:8px 15px;
  background-color:rgba(0,0,0,0.7);
  color:white;
  border-radius:8px;
  font-size:16px;
  z-index:6;
  display:none;
}

/* Ù…Ø±Ø¨Ø¹ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ */
.alertBox {
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background-color:rgba(0,0,0,0.85);
  color:white;
  display:none;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  z-index:10;
}
.alertBox button {
  margin-top:20px;
  padding:10px 30px;
  font-size:18px;
  cursor:pointer;
  border-radius:8px;
  border:none;
}

/* ----- ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø´Ø§Ø´Ù‡ (Ø±Ø¬Ø¹Ù†Ø§Ù‡ ÙƒØ§Ù…Ù„ Ø¨Ø¯ÙˆÙ† Ø­Ø°Ù) ----- */
#rotateNotice {
  position: fixed;
  inset: 0;
  z-index:2000;
  background: rgba(2,6,23,0.92);
  color:#fff;
  display:none;
  justify-content:center;
  align-items:center;
  text-align:center;
  padding:24px;
}

.rotate-content {
  display:grid;
  place-items:center;
  gap:16px;
  max-width:92vw;
}

.rotate-illustration {
  display:block;
  width:min(220px, 48vw);
  height:auto;
}

.rotate-illustration .phone {
  transform-origin:70px 70px;
  animation:phoneTilt 2.4s ease-in-out infinite;
}

.rotate-illustration .arrow {
  transform-origin:0 0;
  animation:arrowSpin 2.6s linear infinite;
}

.rotate-text h2 {
  font-size:clamp(18px,5vw,22px);
  margin:6px 0;
}

.rotate-text p {
  font-size:clamp(14px,3.8vw,16px);
  color:#e5e7eb;
  opacity:0.95;
}

@keyframes phoneTilt {
  0%,100% { transform:rotate(0deg); }
  20% { transform:rotate(-10deg); }
  40% { transform:rotate(12deg); }
  60% { transform:rotate(-8deg); }
  80% { transform:rotate(6deg); }
}

@keyframes arrowSpin {
  0% { transform:rotate(0deg); }
  100% { transform:rotate(360deg); }
}

</style>
</head>

<body>

<!-- Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
<div class="welcome" id="welcome">
  <h1>Laboratory simulation</h1>
  <p>This is an interactive training platform for medical laboratory students.</p>
  <button id="startBtn">START</button>
</div>

<!-- Ø²Ø± NEXT -->
<button id="nextBtn"></button>

<!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø³Ø¤Ø§Ù„ -->
<div class="questionBar" id="questionBar">
  <span>Do you accept samples?</span>
  <button id="yesBtn">Yes</button>
  <button id="noBtn">No</button>
</div>

<!-- Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© -->
<div class="statusBar" id="statusBar">
  <span id="points">100</span>
  <span id="status">case 1</span>
</div>

<!-- Ù…Ø±Ø¨Ø¹ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ -->
<div class="alertBox" id="alertBox">
  <h2 id="alertMsg"></h2>
  <button id="alertBtn">continuation</button>
</div>

<!-- ØªÙ†Ø¨ÙŠÙ‡ ØªØ¯ÙˆÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø© -->
<section id="rotateNotice">
  <div class="rotate-content">
    <svg class="rotate-illustration" width="140" height="140" viewBox="0 0 140 140">
      <g class="phone">
        <rect x="40" y="18" rx="12" ry="12" width="60" height="104" fill="none" stroke="#cbd5e1" stroke-width="4"/>
        <rect x="48" y="30" width="44" height="76" rx="8" ry="8" fill="#0b1220" stroke="rgba(255,255,255,0.08)" />
        <circle cx="70" cy="106" r="3" fill="#cbd5e1"/>
      </g>
      <g class="arrow" transform="translate(70,70)">
        <path d="M 0 -52 A 52 52 0 1 1 -36.77 -36.77" fill="none" stroke="#22c55e" stroke-width="6" stroke-linecap="round"/>
        <polygon points="-36,-36 -50,-40 -42,-28" fill="#22c55e"/>
      </g>
    </svg>
    <div class="rotate-text">
      <h2>Please turn your phone horizontally</h2>
      <p>For the best interactive experience.</p>
    </div>
  </div>
</section>

<!-- Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª -->
<div id="phases">

  <!-- Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ -->
  <video class="phase1" src="A.mp4" playsinline></video>
  <video class="phase1" src="B.mp4" playsinline></video>
  <video class="phase1" src="C.mp4" playsinline></video>
  <video class="phase1" src="D.mp4" playsinline></video>
  <video class="phase1" src="E.mp4" playsinline></video>
  <video class="phase1" src="F.mp4" playsinline></video>
  <video class="phase1" src="G.mp4" playsinline></video>

  <!-- Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© -->
  <video class="phase2" src="A.mp4" playsinline></video>
  <video class="phase2" src="B.mp4" playsinline></video>
  <video class="phase2" src="C.mp4" playsinline></video>
  <video class="phase2" src="D.mp4" playsinline></video>
  <video class="phase2" src="E.mp4" playsinline></video>
  <video class="phase2" src="F.mp4" playsinline></video>
  <video class="phase2" src="P.mp4" playsinline></video>

</div>

<script>
/* Ø§Ù„Ø¹Ù†Ø§ØµØ± */
const startBtn = document.getElementById("startBtn");
const welcome = document.getElementById("welcome");
const nextBtn = document.getElementById("nextBtn");
const questionBar = document.getElementById("questionBar");
const yesBtn = document.getElementById("yesBtn");
const noBtn = document.getElementById("noBtn");
const statusBar = document.getElementById("statusBar");
const pointsEl = document.getElementById("points");
const statusEl = document.getElementById("status");
const alertBox = document.getElementById("alertBox");
const alertMsg = document.getElementById("alertMsg");
const alertBtn = document.getElementById("alertBtn");
const rotateNotice = document.getElementById("rotateNotice");

let currentPhase = 0;
let currentVideoIndex = 0;
let totalPoints = 100;
let phaseEnded = false;
let started = false;
let earlyAlert = false;
let resumeTime = 0;

/* ØªØ®ØµÙŠØµ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª */
const phases = [
  Array.from(document.querySelectorAll(".phase1")),
  Array.from(document.querySelectorAll(".phase2"))
];

/* Ø£Ù…Ø§ÙƒÙ† Ø²Ø± NEXT */
const buttonPositions = [
  {top:"50%", left:"49%", width:"5%", height:"5%"},
  {top:"20%", left:"27%", width:"15%", height:"25%"},
  {top:"11%", left:"55%", width:"15%", height:"25%"},
  {top:"25%", left:"35%", width:"10%", height:"30%"},
  {top:"50%", left:"63%", width:"5%", height:"10%"},
  {top:"20%", left:"39%", width:"3%", height:"20%"},
  {top:"50%", left:"50%", width:"5%", height:"5%"}
];

/* ÙƒØ´Ù Ø§Ù„Ø§ØªØ¬Ø§Ù‡ */
function isLandscape(){
  return window.innerWidth > window.innerHeight;
}
function checkOrientation(){
  const landscape = isLandscape();
  rotateNotice.style.display = landscape ? "none" : "flex";
  const gameVideos = phases.flat();
  gameVideos.forEach(v => { v.style.display = landscape ? v.style.display : "none"; v.pause(); });
  questionBar.style.display = (landscape && started) ? "flex" : "none";
  statusBar.style.display = (landscape && started) ? "flex" : "none";
  return landscape;
}
window.addEventListener("resize", checkOrientation);

/* ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© */
startBtn.addEventListener("click", () => {
  if(!checkOrientation()){ return; }
  started = true;
  welcome.style.display = "none";
  questionBar.style.display = "flex";
  statusBar.style.display = "flex";
  playVideo();
});

/* ØªØ´ØºÙŠÙ„ ÙÙŠØ¯ÙŠÙˆ */
function playVideo(){
  const videos = phases[currentPhase];
  videos.forEach(v => { v.pause(); v.style.display="none"; });

  if(currentVideoIndex < videos.length){
    const vid = videos[currentVideoIndex];
    vid.style.display="block";
    vid.play();
    updateStatus();
    phaseEnded = false;
    earlyAlert = false;
    enableQuestion();
  }
}

/* ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© */
function updateStatus(){
  statusEl.textContent = `case ${currentPhase+1}`;
  pointsEl.textContent = totalPoints;
}

/* Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ */
phases.forEach((phaseVideos)=>{
  phaseVideos.forEach((video,vIndex)=>{

    video.addEventListener("ended", ()=>{

      const pos = buttonPositions[vIndex];
      nextBtn.style.top = pos.top;
      nextBtn.style.left = pos.left;
      nextBtn.style.width = pos.width;
      nextBtn.style.height = pos.height;

      /* âœ¨ Ù„Ø§ Ù†ØºÙŠÙŠØ± Ø§Ù„Ø®Ù„ÙÙŠØ© Ù‡Ù†Ø§ â€” CSS ØªØªØ­ÙƒÙ… */
      nextBtn.style.display="block";

      phaseEnded = true;
    });
  });
});

/* ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø³Ø¤Ø§Ù„ */
function enableQuestion(){
  yesBtn.disabled = false;
  noBtn.disabled = false;
}

/* Ø£Ø²Ø±Ø§Ø± YES/NO */
yesBtn.addEventListener("click", ()=>{
  if(!phaseEnded){
    const vid = phases[currentPhase][currentVideoIndex];
    resumeTime = vid.currentTime;
    vid.pause();
    earlyAlert = true;
    alertMsg.textContent = "â€¼ï¸ Not all procedures have been completedâ€¼ï¸";
    alertBtn.textContent = "Continue";
    alertBox.style.display = "flex";
    return;
  }

  const s = {correctAnswer:"No"};

  if("Yes" !== s.correctAnswer){
    totalPoints -= 10;
    alertMsg.textContent="âŒIncorrect answer, wrong type";
  } else {
    alertMsg.textContent="correct!";
  }

  alertBtn.textContent = "continuation";
  alertBox.style.display="flex";
});

noBtn.addEventListener("click", ()=>{
  if(!phaseEnded){
    const vid = phases[currentPhase][currentVideoIndex];
    resumeTime = vid.currentTime;
    vid.pause();
    earlyAlert = true;
    alertMsg.textContent = "â€¼ï¸ Not all procedures have been completedâ€¼ï¸";
    alertBtn.textContent = "Continue";
    alertBox.style.display = "flex";
    return;
  }

  alertMsg.textContent="correct!";
  alertBtn.textContent = "continuation";
  alertBox.style.display="flex";
});

/* Ø²Ø± Ù…ØªØ§Ø¨Ø¹Ø© Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ */
alertBtn.addEventListener("click", ()=>{

  if(earlyAlert){
    alertBox.style.display="none";
    const vid = phases[currentPhase][currentVideoIndex];
    try { vid.currentTime = resumeTime; } catch(e){}
    vid.play();
    earlyAlert = false;
    return;
  }

  alertBox.style.display="none";
  currentPhase++;

  if(currentPhase < phases.length){
    currentVideoIndex = 0;
    playVideo();
  } else {
    questionBar.style.display="none";
    statusBar.style.display="none";
    alertMsg.textContent=`ğŸ‘All cases complete! Your total points: ${totalPoints}`;
    alertBtn.style.display="none";
    alertBox.style.display="flex";
  }
});

/* Ø²Ø± NEXT */
nextBtn.addEventListener("click", ()=>{
  nextBtn.style.display="none";
  currentVideoIndex++;
  playVideo();
});
</script>

</body>
</html>
